@model IDictionary<string, IEnumerable<TravelAgencyWebApp.ViewModels.Offer.OfferViewModel>>

@{
	ViewData["Title"] = "Добре дошли в Дени Травел";
}

<!DOCTYPE html>
<html lang="bg">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Travelix Project">
	<title>@ViewData["Title"]</title>
	<link rel="stylesheet" type="text/css" href="~/Content/styles/bootstrap4/bootstrap.min.css" asp-append-version="true" />
	<link href="~/Content/plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" asp-append-version="true" />
	<link rel="stylesheet" type="text/css" href="~/Content/plugins/OwlCarousel2-2.2.1/owl.carousel.css" asp-append-version="true" />
	<link rel="stylesheet" type="text/css" href="~/Content/plugins/OwlCarousel2-2.2.1/owl.theme.default.css" asp-append-version="true" />
	<link rel="stylesheet" type="text/css" href="~/Content/styles/main_styles.css" asp-append-version="true" />
	<link rel="stylesheet" type="text/css" href="~/Content/styles/responsive.css" asp-append-version="true" />
</head>
<body>

	<!-- Offers Section -->
	<div class="container mt-5">
		@foreach (var travelingWay in Model.Keys)
		{
			<h3 class="text-center">Почивки и Екскурзии с @travelingWay</h3>
			<div class="row mb-4">
				@foreach (var offer in Model[travelingWay])
				{
					<div class="col-md-4 mb-4">
						<div class="card">
							<img src="@offer.ImageUrl" class="card-img-top" alt="@offer.Title" />
							<div class="card-body">
								<h5 class="card-title">@offer.Title</h5>
								<p class="card-text">@offer.Description</p>
								<p class="card-text"><strong>Цена: @offer.Price.ToString("C")</strong></p>
								<a asp-controller="Offer" asp-action="Details" asp-route-id="@offer.Id" class=" btn btn-info">
									<i class="fas fa-eye"></i>Виж Офертата
								</a>
							</div>
						</div>
					</div>
				}
			</div>
			<hr /> 
		}
	</div>
	<!-- Scripts Section -->
	@section Scripts {
		<script src="~/Content/js/jquery-3.2.1.min.js" asp-append-version="true"></script>
		<script src="~/Content/js/custom.js" asp-append-version="true"></script>

		<script>
			$(document).ready(function () {
				// Search function for filtering table
				$('#searchInput').on('keyup', function () {
					const filter = $(this).val().toLowerCase();
					$('table.table-striped tbody tr').filter(function () {
						const text = $(this).text().toLowerCase();
						// Filter based on the entire row's text
						$(this).toggle(text.indexOf(filter) > -1);
					});
				});

				let deleteOfferId;
				// Show delete modal
				window.showDeleteModal = function (offerId) {
					deleteOfferId = offerId;
					$('#deleteModal').modal('show');
				};

				// Confirm delete functionality
				$('#confirmDelete').on('click', function () {
					if (deleteOfferId) {
						// Redirect to the delete action
						window.location.href = `@Url.Action("Delete", "Offer")/${deleteOfferId}`;
					}
				});
			});
		</script>
	}
</body>
</html>